defmodule Movies.Actor.Name, do: use(Neo.Event)
defmodule Movies.Actor.Born, do: use(Neo.Event)
defmodule Movies.Actor.Died, do: use(Neo.Event)
defmodule Movies.Movie.Title, do: use(Neo.Event)
defmodule Movies.Movie.Year, do: use(Neo.Event)
defmodule Movies.Movie.Director, do: use(Neo.Event)
defmodule Movies.Movie.Cast, do: use(Neo.Event)
defmodule Movies.Movie.Sequel, do: use(Neo.Event)

[
  Movies.Actor.Name.add("James Cameron", "urn:person:100"),
  Movies.Actor.Born.add("1954-08-16", "urn:person:100"),
  Movies.Actor.Name.add("Arnold Schwarzenegger", "urn:person:101"),
  Movies.Actor.Born.add("1947-07-30", "urn:person:101"),
  Movies.Actor.Name.add("Linda Hamilton", "urn:person:102"),
  Movies.Actor.Born.add("1956-09-26", "urn:person:102"),
  Movies.Actor.Name.add("Michael Biehn", "urn:person:103"),
  Movies.Actor.Born.add("1956-07-31", "urn:person:103"),
  Movies.Actor.Name.add("Ted Kotcheff", "urn:person:104"),
  Movies.Actor.Born.add("1931-04-07", "urn:person:104"),
  Movies.Actor.Name.add("Sylvester Stallone", "urn:person:105"),
  Movies.Actor.Born.add("1946-07-06", "urn:person:105"),
  Movies.Actor.Name.add("Richard Crenna", "urn:person:106"),
  Movies.Actor.Born.add("1926-11-30", "urn:person:106"),
  Movies.Actor.Died.add("2003-01-17", "urn:person:106"),
  Movies.Actor.Name.add("Brian Dennehy", "urn:person:107"),
  Movies.Actor.Born.add("1938-07-09", "urn:person:107"),
  Movies.Actor.Name.add("John McTiernan", "urn:person:108"),
  Movies.Actor.Born.add("1951-01-08", "urn:person:108"),
  Movies.Actor.Name.add("Elpidia Carrillo", "urn:person:109"),
  Movies.Actor.Born.add("1961-08-16", "urn:person:109"),
  Movies.Actor.Name.add("Carl Weathers", "urn:person:110"),
  Movies.Actor.Born.add("1948-01-14", "urn:person:110"),
  Movies.Actor.Name.add("Richard Donner", "urn:person:111"),
  Movies.Actor.Born.add("1930-04-24", "urn:person:111"),
  Movies.Actor.Name.add("Mel Gibson", "urn:person:112"),
  Movies.Actor.Born.add("1956-01-03", "urn:person:112"),
  Movies.Actor.Name.add("Danny Glover", "urn:person:113"),
  Movies.Actor.Born.add("1946-07-22", "urn:person:113"),
  Movies.Actor.Name.add("Gary Busey", "urn:person:114"),
  Movies.Actor.Born.add("1944-07-29", "urn:person:114"),
  Movies.Actor.Name.add("Paul Verhoeven", "urn:person:115"),
  Movies.Actor.Born.add("1938-07-18", "urn:person:115"),
  Movies.Actor.Name.add("Peter Weller", "urn:person:116"),
  Movies.Actor.Born.add("1947-06-24", "urn:person:116"),
  Movies.Actor.Name.add("Nancy Allen", "urn:person:117"),
  Movies.Actor.Born.add("1950-06-24", "urn:person:117"),
  Movies.Actor.Name.add("Ronny Cox", "urn:person:118"),
  Movies.Actor.Born.add("1938-07-23", "urn:person:118"),
  Movies.Actor.Name.add("Mark L. Lester", "urn:person:119"),
  Movies.Actor.Born.add("1946-11-26", "urn:person:119"),
  Movies.Actor.Name.add("Rae Dawn Chong", "urn:person:120"),
  Movies.Actor.Born.add("1961-02-28", "urn:person:120"),
  Movies.Actor.Name.add("Alyssa Milano", "urn:person:121"),
  Movies.Actor.Born.add("1972-12-19", "urn:person:121"),
  Movies.Actor.Name.add("Bruce Willis", "urn:person:122"),
  Movies.Actor.Born.add("1955-03-19", "urn:person:122"),
  Movies.Actor.Name.add("Alan Rickman", "urn:person:123"),
  Movies.Actor.Born.add("1946-02-21", "urn:person:123"),
  Movies.Actor.Name.add("Alexander Godunov", "urn:person:124"),
  Movies.Actor.Born.add("1949-11-28", "urn:person:124"),
  Movies.Actor.Died.add("1995-05-18", "urn:person:124"),
  Movies.Actor.Name.add("Robert Patrick", "urn:person:125"),
  Movies.Actor.Born.add("1958-11-05", "urn:person:125"),
  Movies.Actor.Name.add("Edward Furlong", "urn:person:126"),
  Movies.Actor.Born.add("1977-08-02", "urn:person:126"),
  Movies.Actor.Name.add("Jonathan Mostow", "urn:person:127"),
  Movies.Actor.Born.add("1961-11-28", "urn:person:127"),
  Movies.Actor.Name.add("Nick Stahl", "urn:person:128"),
  Movies.Actor.Born.add("1979-12-05", "urn:person:128"),
  Movies.Actor.Name.add("Claire Danes", "urn:person:129"),
  Movies.Actor.Born.add("1979-04-12", "urn:person:129"),
  Movies.Actor.Name.add("George P. Cosmatos", "urn:person:130"),
  Movies.Actor.Born.add("1941-01-04", "urn:person:130"),
  Movies.Actor.Died.add("2005-04-19", "urn:person:130"),
  Movies.Actor.Name.add("Charles Napier", "urn:person:131"),
  Movies.Actor.Born.add("1936-04-12", "urn:person:131"),
  Movies.Actor.Died.add("2011-10-05", "urn:person:131"),
  Movies.Actor.Name.add("Peter MacDonald", "urn:person:132"),
  Movies.Actor.Name.add("Marc de Jonge", "urn:person:133"),
  Movies.Actor.Born.add("1949-02-16", "urn:person:133"),
  Movies.Actor.Died.add("1996-06-06", "urn:person:133"),
  Movies.Actor.Name.add("Stephen Hopkins", "urn:person:134"),
  Movies.Actor.Name.add("Ruben Blades", "urn:person:135"),
  Movies.Actor.Born.add("1948-07-16", "urn:person:135"),
  Movies.Actor.Name.add("Joe Pesci", "urn:person:136"),
  Movies.Actor.Born.add("1943-02-09", "urn:person:136"),
  Movies.Actor.Name.add("Ridley Scott", "urn:person:137"),
  Movies.Actor.Born.add("1937-11-30", "urn:person:137"),
  Movies.Actor.Name.add("Tom Skerritt", "urn:person:138"),
  Movies.Actor.Born.add("1933-08-25", "urn:person:138"),
  Movies.Actor.Name.add("Sigourney Weaver", "urn:person:139"),
  Movies.Actor.Born.add("1949-10-08", "urn:person:139"),
  Movies.Actor.Name.add("Veronica Cartwright", "urn:person:140"),
  Movies.Actor.Born.add("1949-04-20", "urn:person:140"),
  Movies.Actor.Name.add("Carrie Henn", "urn:person:141"),
  Movies.Actor.Name.add("George Miller", "urn:person:142"),
  Movies.Actor.Born.add("1945-03-03", "urn:person:142"),
  Movies.Actor.Name.add("Steve Bisley", "urn:person:143"),
  Movies.Actor.Born.add("1951-12-26", "urn:person:143"),
  Movies.Actor.Name.add("Joanne Samuel", "urn:person:144"),
  Movies.Actor.Name.add("Michael Preston", "urn:person:145"),
  Movies.Actor.Born.add("1938-05-14", "urn:person:145"),
  Movies.Actor.Name.add("Bruce Spence", "urn:person:146"),
  Movies.Actor.Born.add("1945-09-17", "urn:person:146"),
  Movies.Actor.Name.add("George Ogilvie", "urn:person:147"),
  Movies.Actor.Born.add("1931-03-05", "urn:person:147"),
  Movies.Actor.Name.add("Tina Turner", "urn:person:148"),
  Movies.Actor.Born.add("1939-11-26", "urn:person:148"),
  Movies.Actor.Name.add("Sophie Marceau", "urn:person:149"),
  Movies.Actor.Born.add("1966-11-17", "urn:person:149"),
  Movies.Movie.Title.add("The Terminator", "urn:movie:200"),
  Movies.Movie.Year.add(1984, "urn:movie:200"),
  Movies.Movie.Director.add("urn:person:100", "urn:movie:200"),
  Movies.Movie.Cast.add("urn:person:101", "urn:movie:200"),
  Movies.Movie.Cast.add("urn:person:102", "urn:movie:200"),
  Movies.Movie.Cast.add("urn:person:103", "urn:movie:200"),
  Movies.Movie.Sequel.add("urn:movie:207", "urn:movie:200"),
  Movies.Movie.Title.add("First Blood", "urn:movie:201"),
  Movies.Movie.Year.add(1982, "urn:movie:201"),
  Movies.Movie.Director.add("urn:person:104", "urn:movie:201"),
  Movies.Movie.Cast.add("urn:person:105", "urn:movie:201"),
  Movies.Movie.Cast.add("urn:person:106", "urn:movie:201"),
  Movies.Movie.Cast.add("urn:person:107", "urn:movie:201"),
  Movies.Movie.Sequel.add("urn:movie:209", "urn:movie:201"),
  Movies.Movie.Title.add("Predator", "urn:movie:202"),
  Movies.Movie.Year.add(1987, "urn:movie:202"),
  Movies.Movie.Director.add("urn:person:108", "urn:movie:202"),
  Movies.Movie.Cast.add("urn:person:101", "urn:movie:202"),
  Movies.Movie.Cast.add("urn:person:109", "urn:movie:202"),
  Movies.Movie.Cast.add("urn:person:110", "urn:movie:202"),
  Movies.Movie.Sequel.add("urn:movie:211", "urn:movie:202"),
  Movies.Movie.Title.add("Lethal Weapon", "urn:movie:203"),
  Movies.Movie.Year.add(1987, "urn:movie:203"),
  Movies.Movie.Director.add("urn:person:111", "urn:movie:203"),
  Movies.Movie.Cast.add("urn:person:112", "urn:movie:203"),
  Movies.Movie.Cast.add("urn:person:113", "urn:movie:203"),
  Movies.Movie.Cast.add("urn:person:114", "urn:movie:203"),
  Movies.Movie.Sequel.add("urn:movie:212", "urn:movie:203"),
  Movies.Movie.Title.add("RoboCop", "urn:movie:204"),
  Movies.Movie.Year.add(1987, "urn:movie:204"),
  Movies.Movie.Director.add("urn:person:115", "urn:movie:204"),
  Movies.Movie.Cast.add("urn:person:116", "urn:movie:204"),
  Movies.Movie.Cast.add("urn:person:117", "urn:movie:204"),
  Movies.Movie.Cast.add("urn:person:118", "urn:movie:204"),
  Movies.Movie.Title.add("Commando", "urn:movie:205"),
  Movies.Movie.Year.add(1985, "urn:movie:205"),
  Movies.Movie.Director.add("urn:person:119", "urn:movie:205"),
  Movies.Movie.Cast.add("urn:person:101", "urn:movie:205"),
  Movies.Movie.Cast.add("urn:person:120", "urn:movie:205"),
  Movies.Movie.Cast.add("urn:person:121", "urn:movie:205"),
  Movies.Movie.Title.add("Die Hard", "urn:movie:206"),
  Movies.Movie.Year.add(1988, "urn:movie:206"),
  Movies.Movie.Director.add("urn:person:108", "urn:movie:206"),
  Movies.Movie.Cast.add("urn:person:122", "urn:movie:206"),
  Movies.Movie.Cast.add("urn:person:123", "urn:movie:206"),
  Movies.Movie.Cast.add("urn:person:124", "urn:movie:206"),
  Movies.Movie.Title.add("Terminator 2: Judgment Day", "urn:movie:207"),
  Movies.Movie.Year.add(1991, "urn:movie:207"),
  Movies.Movie.Director.add("urn:person:100", "urn:movie:207"),
  Movies.Movie.Cast.add("urn:person:101", "urn:movie:207"),
  Movies.Movie.Cast.add("urn:person:102", "urn:movie:207"),
  Movies.Movie.Cast.add("urn:person:125", "urn:movie:207"),
  Movies.Movie.Cast.add("urn:person:126", "urn:movie:207"),
  Movies.Movie.Sequel.add("urn:movie:208", "urn:movie:207"),
  Movies.Movie.Title.add("Terminator 3: Rise of the Machines", "urn:movie:208"),
  Movies.Movie.Year.add(2003, "urn:movie:208"),
  Movies.Movie.Director.add("urn:person:127", "urn:movie:208"),
  Movies.Movie.Cast.add("urn:person:101", "urn:movie:208"),
  Movies.Movie.Cast.add("urn:person:128", "urn:movie:208"),
  Movies.Movie.Cast.add("urn:person:129", "urn:movie:208"),
  Movies.Movie.Title.add("Rambo: First Blood Part II", "urn:movie:209"),
  Movies.Movie.Year.add(1985, "urn:movie:209"),
  Movies.Movie.Director.add("urn:person:130", "urn:movie:209"),
  Movies.Movie.Cast.add("urn:person:105", "urn:movie:209"),
  Movies.Movie.Cast.add("urn:person:106", "urn:movie:209"),
  Movies.Movie.Cast.add("urn:person:131", "urn:movie:209"),
  Movies.Movie.Sequel.add("urn:movie:210", "urn:movie:209"),
  Movies.Movie.Title.add("Rambo III", "urn:movie:210"),
  Movies.Movie.Year.add(1988, "urn:movie:210"),
  Movies.Movie.Director.add("urn:person:132", "urn:movie:210"),
  Movies.Movie.Cast.add("urn:person:105", "urn:movie:210"),
  Movies.Movie.Cast.add("urn:person:106", "urn:movie:210"),
  Movies.Movie.Cast.add("urn:person:133", "urn:movie:210"),
  Movies.Movie.Title.add("Predator 2", "urn:movie:211"),
  Movies.Movie.Year.add(1990, "urn:movie:211"),
  Movies.Movie.Director.add("urn:person:134", "urn:movie:211"),
  Movies.Movie.Cast.add("urn:person:113", "urn:movie:211"),
  Movies.Movie.Cast.add("urn:person:114", "urn:movie:211"),
  Movies.Movie.Cast.add("urn:person:135", "urn:movie:211"),
  Movies.Movie.Title.add("Lethal Weapon 2", "urn:movie:212"),
  Movies.Movie.Year.add(1989, "urn:movie:212"),
  Movies.Movie.Director.add("urn:person:111", "urn:movie:212"),
  Movies.Movie.Cast.add("urn:person:112", "urn:movie:212"),
  Movies.Movie.Cast.add("urn:person:113", "urn:movie:212"),
  Movies.Movie.Cast.add("urn:person:136", "urn:movie:212"),
  Movies.Movie.Sequel.add("urn:movie:213", "urn:movie:212"),
  Movies.Movie.Title.add("Lethal Weapon 3", "urn:movie:213"),
  Movies.Movie.Year.add(1992, "urn:movie:213"),
  Movies.Movie.Director.add("urn:person:111", "urn:movie:213"),
  Movies.Movie.Cast.add("urn:person:112", "urn:movie:213"),
  Movies.Movie.Cast.add("urn:person:113", "urn:movie:213"),
  Movies.Movie.Cast.add("urn:person:136", "urn:movie:213"),
  Movies.Movie.Title.add("Alien", "urn:movie:214"),
  Movies.Movie.Year.add(1979, "urn:movie:214"),
  Movies.Movie.Director.add("urn:person:137", "urn:movie:214"),
  Movies.Movie.Cast.add("urn:person:138", "urn:movie:214"),
  Movies.Movie.Cast.add("urn:person:139", "urn:movie:214"),
  Movies.Movie.Cast.add("urn:person:140", "urn:movie:214"),
  Movies.Movie.Sequel.add("urn:movie:215", "urn:movie:214"),
  Movies.Movie.Title.add("Aliens", "urn:movie:215"),
  Movies.Movie.Year.add(1986, "urn:movie:215"),
  Movies.Movie.Director.add("urn:person:100", "urn:movie:215"),
  Movies.Movie.Cast.add("urn:person:139", "urn:movie:215"),
  Movies.Movie.Cast.add("urn:person:141", "urn:movie:215"),
  Movies.Movie.Cast.add("urn:person:103", "urn:movie:215"),
  Movies.Movie.Title.add("Mad Max", "urn:movie:216"),
  Movies.Movie.Year.add(1979, "urn:movie:216"),
  Movies.Movie.Director.add("urn:person:142", "urn:movie:216"),
  Movies.Movie.Cast.add("urn:person:112", "urn:movie:216"),
  Movies.Movie.Cast.add("urn:person:143", "urn:movie:216"),
  Movies.Movie.Cast.add("urn:person:144", "urn:movie:216"),
  Movies.Movie.Sequel.add("urn:movie:217", "urn:movie:216"),
  Movies.Movie.Title.add("Mad Max 2", "urn:movie:217"),
  Movies.Movie.Year.add(1981, "urn:movie:217"),
  Movies.Movie.Director.add("urn:person:142", "urn:movie:217"),
  Movies.Movie.Cast.add("urn:person:112", "urn:movie:217"),
  Movies.Movie.Cast.add("urn:person:145", "urn:movie:217"),
  Movies.Movie.Cast.add("urn:person:146", "urn:movie:217"),
  Movies.Movie.Sequel.add("urn:movie:218", "urn:movie:217"),
  Movies.Movie.Title.add("Mad Max Beyond Thunderdome", "urn:movie:218"),
  Movies.Movie.Year.add(1985, "urn:movie:218"),
  Movies.Movie.Director.add("urn:person:142", "urn:movie:218"),
  Movies.Movie.Director.add("urn:person:147", "urn:movie:218"),
  Movies.Movie.Cast.add("urn:person:112", "urn:movie:218"),
  Movies.Movie.Cast.add("urn:person:148", "urn:movie:218"),
  Movies.Movie.Title.add("Braveheart", "urn:movie:219"),
  Movies.Movie.Year.add(1995, "urn:movie:219"),
  Movies.Movie.Director.add("urn:person:112", "urn:movie:219"),
  Movies.Movie.Cast.add("urn:person:112", "urn:movie:219"),
  Movies.Movie.Cast.add("urn:person:149", "urn:movie:219")
]
|> Enum.map(&Neo.Repo.commit(&1))

defmodule Neo.QueryTest do
  use ExUnit.Case
  import Neo.Query

  defmodule Movie.Year, do: use(Neo.Event)
  defmodule Movie.Title, do: use(Neo.Event)

  test "commits and retrieves an event" do
    # fact :id, :title do
    #   Movie.Year.is(1987)
    #   Movie.Title.find(:title)
    # end

    Neo.Query.run()

    # assert ids == [1]

    #   [where: {@e, User.FirstName, "John"})]
    # end
    # assert result == [1]
  end
end

# q = :datalog.p('
# ?- h(_, _).
# f(s, p, o).
# h(s, title) :-
#     f(s, \"year\", 1987),
#     f(s, \"title\", title).
# ')
# IO.inspect(q)
# e = :datalog.c(:datalog_list, q)
# s = :datalog.q(e, [{:a, 1}, {:b, 2}, {:c, 3}])
# IO.inspect(s)
# # assert ids == [1]
